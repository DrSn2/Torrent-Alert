<dom-module id="torrent-list-item">
  <style>
  paper-icon-item {
    border-bottom: 1px solid #EEE;
    border-top: 1px solid #EEE;
  }
  
  paper-icon-item paper-item-body {
    padding: 8px 0;
  }
  
  .verified {
    color: var(--paper-teal-500);
  }
  
  .white-space-normal {
    white-space: normal;
  }
  </style>

  <template>
    <div class="center-justified horizontal layout">
      <div class="li">
        <paper-icon-item class="cursor-p white" on-tap="_tap">
          <selectable-icon icon_class="[[return_icon_class(item.category)]]" icon_text="[[return_text(item.count)]]" id="selectable_icon" item-icon selected$="{{selected}}"></selectable-icon>

          <paper-item-body two-line>
            <div class="horizontal justified layout" secondary>
              <div>[[item.category]]</div>
              <div class="verified">[[item.verified]]</div>
            </div>
            <div class="white-space-normal">[[item.title]]</div>
            <div class="horizontal justified layout" secondary>
              <div>[[item.size]] | [[item.leech]]L / [[item.seed]]S</div>
              <div>[[return_time(item.time)]]</div>
            </div>
          </paper-item-body>
        </paper-icon-item>
      </div>
    </div>
  </template>
</dom-module>

<script>
(function() {
  Polymer({

    _tap: function(e) {
      if (Polymer.dom(e).localTarget.id != 'selectable_icon') {
        e.stopPropagation();

        FlowRouter.go("/torrent", {}, {
          torrent: this.item._id,
          route: 'torrent-item',
          previous: Base64.encode(ascii_array(FlowRouter.current().path)),
        });
      }
    },

    is: 'torrent-list-item',

    return_icon_class: function(text) {
      return polymer_color(text ? text : '#');
    },

    return_text: function(text) {
      return (text ? text : '#');
    },

    return_time: function(time) {
      return (moment(time).isValid() ? moment(time).format('MMM DD ddd') : '#');
    },

  });
})();
</script>
