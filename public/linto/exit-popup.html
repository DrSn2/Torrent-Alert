<polymer-element attributes="time" name="exit-popup">
    <template>
        <paper-dialog backdrop id="exitCallback" transition="core-transition-bottom">
            <div layout vertical>
                <div class="padding-24">Are you sure you want to exit ?</div>
                <div class="paper-dialog-title" horizontal layout reverse>
                    <paper-button core-overlay-toggle on-tap="{{exitOk}}">
                        <core-icon icon="check"></core-icon>&nbsp;&nbsp;Ok
                    </paper-button>
                    <paper-button core-overlay-toggle>
                        <core-icon icon="clear"></core-icon>&nbsp;&nbsp;Cancel
                    </paper-button>
                </div>
            </div>
        </paper-dialog>
    </template>

    <script>
    Polymer("confirm-exit", {

        time: null,
        time_store: moment().format("x"),

        exitOk: function() {
            if (document.querySelector("html /deep/ layout-inbox")) {
                document.querySelector("html /deep/ layout-inbox").save();
            }

            // Meteor.setTimeout(function() {
            navigator.app.exitApp();
            // }, 400);
        },

        timeChanged: function() {
            if ((parseInt(this.time) - parseInt(this.time_store)) < 2000) {
                this.$.exitCallback.open();
            }

            this.time_store = moment().format("x");
        }

    });
    </script>
</polymer-element>
